# Диаграмма классов

![cli/CLI.svg](CLI.svg)

# Выполнили
1. [Киселёв Михаил, 21.Б07-мм](https://github.com/true-real-michael)
2. [Громова Арабелла, 21.Б10-мм](https://github.com/rongirl)
3. [Житнухина Мария, 21.Б10-мм](https://github.com/zhitm)


# Компоненты системы


## AST (Abstract Syntax Tree):

Этот компонент отвечает за представление абстрактного синтаксического дерева, описывающего команды, введенные пользователем.

### IASTNode
Интерфейс для узлов AST.
### LiteralsASTNode
Узел, соответствующий командам, аргументам, переменным окружения для присвоения.
### PipeASTNode
Узел, соответствующий оператору `|`, связывает два других узла.
### EnvVarSetASTNode
Узел, соответствующий заданию переменных окружения.

## Commands
Содержит интерфейсы для команд и фабрик, а также конкретные команды и соответствующие фабрики.
При выполнении команды принимают `Environment` и аргументы.

## Interpreter
Принимает и выполняет команды пользователя
### Client
Отвечает за взаимодействие с пользователем. Бесконечный цикл в `run()` считывает команды пользователя и передает их в `Interpreter.process_input(string)`. Получив ответ, печатает результат или завершает работу программы.
### CommandMatcher
Используется для нахождения команды и создания объекта команды по строке.
### Environment
Отвечает за хранение переменных окружения. Немутабельный, чтобы реализации команд не могли менять значения переменных. `add(string, string)` и `remove(string)` возвращают новый объект.
### Lexer
Разбивает пользовательский ввод на токены и подставляет переменные окружения.
### Parser
Вызывает `Lexer.tokenize(Environment, string)`, а затем на основе списка токенов создает AST.
### ASTVisitor
Посетитель, который обходит узлы AST и выполняет соответствующие команды. Включает методы для обработки литералов, пайплайнов и установки переменных окружения. Если при обработке `LiteralsASTNode` первый литерал -- "exit", возвращает ошибку, которая сигнализирует о завершении работы программы.
### Interpreter
При вызове `process_input(string)`, преобразует строку в AST с помощью `Parser.parse(Environment, string)`. А затем обрабатывает AST с помощью посетителя `ASTVisitor`. Так как во время обработки AST могло произойти изменение переменных окуржения, обновляет поле `environment` с помощью `ASTVisitor.get_environment()`. Результат работы ASTVisitor обработки возвращает.

## Расширяемость
Для добавления новой команды нужно создать класс, реализующий `ICommand`, и соответствующую фабрику, реализующую `ICommandFactory`. Фабрику необходимо добавить в `CommandMatcher.command_factories`. С помощью ключевого слова `ICommandFactory.name` можно будет вызвать команду.